#!/usr/bin/env python3
"""
å€™é¸èœå“æ± è¨­è¨ˆï¼šæ›èœé‚è¼¯çš„è³‡æ–™ä¾†æºç­–ç•¥
"""

print("=" * 80)
print("ğŸ² å€™é¸èœå“æ± è¨­è¨ˆæ–¹æ¡ˆ")
print("=" * 80)
print()

print("## ğŸ¯ æ ¸å¿ƒåŸå‰‡")
print()
print("âŒ éŒ¯èª¤åšæ³•ï¼šæ›èœæ™‚å¾ã€Œæ•´å€‹é¤å»³èœå–®ã€éš¨æ©Ÿé¸æ“‡")
print("âœ… æ­£ç¢ºåšæ³•ï¼šåªèƒ½å¾ã€ŒAI é å…ˆæ¨è–¦çš„å€™é¸æ± ã€ä¸­é¸æ“‡")
print()
print("åŸå› ï¼š")
print("  1. ç¢ºä¿æ¨è–¦å“è³ªï¼ˆæ¯é“èœéƒ½ç¶“é AI è©•ä¼°ï¼‰")
print("  2. é¿å…æ¨è–¦ä¸é©åˆçš„èœå“ï¼ˆä¾‹å¦‚ï¼šä½¿ç”¨è€…ä¸åƒè¾£ï¼Œå»æ¨è–¦éº»è¾£é‹ï¼‰")
print("  3. æ§åˆ¶åƒ¹æ ¼ç¯„åœï¼ˆå€™é¸æ± çš„èœå“åƒ¹æ ¼æ‡‰è©²æ¥è¿‘ï¼‰")
print()

print("=" * 80)
print("ğŸ“‹ æ–¹æ¡ˆæ¯”è¼ƒ")
print("=" * 80)
print()

print("### æ–¹æ¡ˆ Aï¼šè¼ªæ’­æ± ï¼ˆRotation Poolï¼‰")
print()
print("```")
print("AI ä¸€æ¬¡æ¨è–¦ 3-5 é“å€™é¸èœå“ï¼Œå‰ç«¯è¼ªæ’­")
print()
print("åˆå§‹é¡¯ç¤ºï¼š")
print("  ç†±èœï¼šå®®ä¿é›ä¸ ($180)")
print()
print("å€™é¸æ± ï¼ˆéš±è—ï¼‰ï¼š")
print("  ç†±èœ: [å®®ä¿é›ä¸, ç³–é†‹é­š, ç´…ç‡’è‚‰]")
print()
print("æ›èœæµç¨‹ï¼š")
print("  ç¬¬1æ¬¡æ› â†’ ç³–é†‹é­š ($220)")
print("  ç¬¬2æ¬¡æ› â†’ ç´…ç‡’è‚‰ ($280)")
print("  ç¬¬3æ¬¡æ› â†’ å®®ä¿é›ä¸ (å›åˆ°ç¬¬ä¸€å€‹)")
print("```")
print()
print("å„ªé»ï¼š")
print("  âœ… å‰ç«¯å¯¦ä½œç°¡å–®ï¼ˆä¸éœ€å‘¼å« APIï¼‰")
print("  âœ… å›æ‡‰é€Ÿåº¦å¿«ï¼ˆç„¡ç¶²è·¯å»¶é²ï¼‰")
print("  âœ… å€™é¸æ± å¤§å°å¯æ§ï¼ˆ3-5 é“ï¼‰")
print()
print("ç¼ºé»ï¼š")
print("  âŒ é¸æ“‡æœ‰é™ï¼ˆåªæœ‰ 3-5 å€‹é¸é …ï¼‰")
print("  âŒ åˆå§‹è¼‰å…¥é‡è¼ƒå¤§ï¼ˆéœ€è¦é è¼‰æ‰€æœ‰å€™é¸èœå“è³‡æ–™ï¼‰")
print()

print("=" * 80)
print()

print("### æ–¹æ¡ˆ Bï¼šå‹•æ…‹å–å¾—ï¼ˆAPI Fetchï¼‰")
print()
print("```")
print("AI åªæ¨è–¦ 1 é“é¡¯ç¤ºèœå“ï¼Œæ›èœæ™‚å³æ™‚å‘¼å« API")
print()
print("åˆå§‹é¡¯ç¤ºï¼š")
print("  ç†±èœï¼šå®®ä¿é›ä¸ ($180)")
print()
print("æ›èœæµç¨‹ï¼š")
print("  é»æ“Šã€Œæ›ä¸€é“ã€")
print("    â†“")
print("  POST /api/recommendations/{id}/replace")
print("  { category: 'ç†±èœ', excluded: ['å®®ä¿é›ä¸'] }")
print("    â†“")
print("  å›æ‡‰ï¼šç³–é†‹é­š ($220)")
print()
print("å¾Œç«¯é‚è¼¯ï¼š")
print("  1. å¾ã€Œè©²é¡åˆ¥çš„å€™é¸æ± ã€ä¸­éæ¿¾")
print("  2. æ’é™¤å·²ç¶“è¢«æ›æ‰çš„èœå“")
print("  3. æ ¹æ“šè©•åˆ†è¿”å›æœ€ä½³å€™é¸")
print("```")
print()
print("å„ªé»ï¼š")
print("  âœ… åˆå§‹è¼‰å…¥è¼•é‡ï¼ˆåªéœ€é¡¯ç¤ºçš„èœå“ï¼‰")
print("  âœ… å¯å‹•æ…‹èª¿æ•´ï¼ˆæ ¹æ“šä½¿ç”¨è€…è¡Œç‚ºï¼‰")
print("  âœ… å€™é¸æ± å¯ä»¥æ›´å¤§ï¼ˆ10-20 é“ï¼‰")
print()
print("ç¼ºé»ï¼š")
print("  âŒ éœ€è¦ç¶²è·¯è«‹æ±‚ï¼ˆæœ‰å»¶é²ï¼‰")
print("  âŒ å¾Œç«¯é‚è¼¯è¼ƒè¤‡é›œ")
print()

print("=" * 80)
print()

print("### æ–¹æ¡ˆ Cï¼šæ··åˆç­–ç•¥ï¼ˆæ¨è–¦ â­ï¼‰")
print()
print("```")
print("AI æ¨è–¦ã€Œ1 é“é¡¯ç¤º + 2-3 é“å‚™é¸ã€ï¼Œå‰ç«¯å…ˆè¼ªæ’­ï¼Œä¸å¤ æ™‚å‘¼å« API")
print()
print("åˆå§‹æ¨è–¦ï¼š")
print("  ç†±èœ: {")
print("    display: å®®ä¿é›ä¸ ($180),")
print("    alternatives: [ç³–é†‹é­š ($220), ç´…ç‡’è‚‰ ($280)]")
print("  }")
print()
print("æ›èœæµç¨‹ï¼š")
print("  ç¬¬1æ¬¡æ› â†’ ç³–é†‹é­š (å¾ alternatives)")
print("  ç¬¬2æ¬¡æ› â†’ ç´…ç‡’è‚‰ (å¾ alternatives)")
print("  ç¬¬3æ¬¡æ› â†’ å‘¼å« API å–å¾—æ›´å¤šå€™é¸")
print("```")
print()
print("å„ªé»ï¼š")
print("  âœ… å¹³è¡¡é€Ÿåº¦èˆ‡å½ˆæ€§")
print("  âœ… åˆå§‹è¼‰å…¥é‡é©ä¸­")
print("  âœ… å‚™é¸ç”¨å®Œå†å‘¼å« API")
print()
print("ç¼ºé»ï¼š")
print("  âš ï¸  å¯¦ä½œç•¥è¤‡é›œï¼ˆéœ€è¦ç‹€æ…‹ç®¡ç†ï¼‰")
print()

print("=" * 80)
print("ğŸ† æ¨è–¦æ–¹æ¡ˆï¼šæ–¹æ¡ˆ Cï¼ˆæ··åˆç­–ç•¥ï¼‰")
print("=" * 80)
print()

print("ç†ç”±ï¼š")
print("  1. å¤§éƒ¨åˆ†ä½¿ç”¨è€…åªæœƒæ› 1-2 æ¬¡ï¼Œå‚™é¸æ± è¶³å¤ ")
print("  2. å°‘æ•¸ä½¿ç”¨è€…æ›å¾ˆå¤šæ¬¡ï¼Œå¯ç”¨ API è£œå……")
print("  3. åˆå§‹è¼‰å…¥é‡ä¸æœƒéå¤§")
print()

print("=" * 80)
print("ğŸ“ è³‡æ–™çµæ§‹è¨­è¨ˆ")
print("=" * 80)
print()

print("### API å›æ‡‰æ ¼å¼ï¼ˆæ–¹æ¡ˆ Cï¼‰")
print()
print("```json")
print("{")
print('  "recommendation_id": "abc123",')
print('  "items": [')
print("    {")
print('      "category": "ç†±èœ",')
print('      "display": {')
print('        "name": "å®®ä¿é›ä¸",')
print('        "price": 180,')
print('        "reason": "é¦™è¾£é©ä¸­...",')
print('        "review_count": 234')
print("      },")
print('      "alternatives": [')
print("        {")
print('          "name": "ç³–é†‹é­š",')
print('          "price": 220,')
print('          "reason": "é…¸ç”œå¯å£...",')
print('          "review_count": 189')
print("        },")
print("        {")
print('          "name": "ç´…ç‡’è‚‰",')
print('          "price": 280,')
print('          "reason": "è‚¥è€Œä¸è†©...",')
print('          "review_count": 312')
print("        }")
print("      ]")
print("    },")
print("    {")
print('      "category": "å†·èœ",')
print('      "display": {')
print('        "name": "æ¶¼æ‹Œé»ƒç“œ",')
print('        "price": 80,')
print('        "reason": "æ¸…çˆ½é–‹èƒƒ...",')
print('        "review_count": 156')
print("      },")
print('      "alternatives": [')
print("        {")
print('          "name": "çš®è›‹è±†è…",')
print('          "price": 100,')
print('          "reason": "å£æ„Ÿæ»‘å«©...",')
print('          "review_count": 142')
print("        }")
print("      ]")
print("    }")
print("  ]")
print("}")
print("```")
print()

print("=" * 80)
print("ğŸ’» å‰ç«¯å¯¦ä½œé‚è¼¯")
print("=" * 80)
print()

print("### State è¨­è¨ˆ")
print()
print("```typescript")
print("interface DishSlot {")
print("    category: string;")
print("    currentDish: MenuItem;  // ç•¶å‰é¡¯ç¤ºçš„èœå“")
print("    alternatives: MenuItem[];  // å‚™é¸èœå“æ± ")
print("    replacedDishes: string[];  // å·²ç¶“æ›æ‰çš„èœå")
print("    status: 'pending' | 'selected';")
print("}")
print()
print("const [dishSlots, setDishSlots] = useState<DishSlot[]>([]);")
print("```")
print()

print("### æ›èœé‚è¼¯")
print()
print("```typescript")
print("const handleReplaceDish = async (slotIndex: number) => {")
print("    const slot = dishSlots[slotIndex];")
print("    ")
print("    // 1. å…ˆå¾å‚™é¸æ± å–å¾—")
print("    if (slot.alternatives.length > 0) {")
print("        const nextDish = slot.alternatives[0];")
print("        ")
print("        setDishSlots(prev => prev.map((s, i) => {")
print("            if (i !== slotIndex) return s;")
print("            ")
print("            return {")
print("                ...s,")
print("                currentDish: nextDish,")
print("                alternatives: s.alternatives.slice(1),  // ç§»é™¤ç¬¬ä¸€å€‹")
print("                replacedDishes: [...s.replacedDishes, s.currentDish.name]")
print("            };")
print("        }));")
print("    } else {")
print("        // 2. å‚™é¸æ± ç”¨å®Œï¼Œå‘¼å« API")
print("        const newDish = await fetchReplacement(")
print("            slot.category,")
print("            slot.replacedDishes")
print("        );")
print("        ")
print("        setDishSlots(prev => prev.map((s, i) => {")
print("            if (i !== slotIndex) return s;")
print("            ")
print("            return {")
print("                ...s,")
print("                currentDish: newDish,")
print("                replacedDishes: [...s.replacedDishes, s.currentDish.name]")
print("            };")
print("        }));")
print("    }")
print("};")
print("```")
print()

print("=" * 80)
print("ğŸ”§ å¾Œç«¯å¯¦ä½œé‚è¼¯")
print("=" * 80)
print()

print("### 1. åˆå§‹æ¨è–¦ï¼ˆgenerate_recommendationsï¼‰")
print()
print("```python")
print("def generate_recommendations(restaurant_name, people, budget, dietary):")
print("    '''")
print("    ç”Ÿæˆåˆå§‹æ¨è–¦ï¼ˆ1 é¡¯ç¤º + 2-3 å‚™é¸ï¼‰")
print("    '''")
print("    # 1. å–å¾—é¤å»³è³‡è¨Šèˆ‡è©•è«–")
print("    reviews = fetch_restaurant_reviews(restaurant_name)")
print("    ")
print("    # 2. ä½¿ç”¨ AI ç”Ÿæˆå€™é¸æ± ï¼ˆæ¯å€‹é¡åˆ¥ 4-5 é“ï¼‰")
print("    candidate_pools = {}")
print("    for category in ['å†·èœ', 'ç†±èœ', 'ä¸»é£Ÿ', 'æ¹¯å“']:")
print("        candidates = ai_recommend_dishes(")
print("            category=category,")
print("            reviews=reviews,")
print("            people=people,")
print("            budget=budget,")
print("            dietary=dietary,")
print("            top_k=4  # æ¯é¡å– 4 é“")
print("        )")
print("        candidate_pools[category] = candidates")
print("    ")
print("    # 3. åˆ†é…é¡¯ç¤º vs å‚™é¸")
print("    recommendations = []")
print("    for category, candidates in candidate_pools.items():")
print("        recommendations.append({")
print("            'category': category,")
print("            'display': candidates[0],  # ç¬¬ä¸€é“é¡¯ç¤º")
print("            'alternatives': candidates[1:3]  # ç¬¬ 2-3 é“ä½œç‚ºå‚™é¸")
print("        })")
print("    ")
print("    return recommendations")
print("```")
print()

print("### 2. æ›èœ APIï¼ˆreplace_dishï¼‰")
print()
print("```python")
print("def replace_dish(recommendation_id, category, excluded_dishes):")
print("    '''")
print("    ç•¶å‚™é¸æ± ç”¨å®Œæ™‚ï¼Œå‹•æ…‹å–å¾—æ–°å€™é¸")
print("    '''")
print("    # 1. å–å¾—åŸå§‹æ¨è–¦çš„ä¸Šä¸‹æ–‡")
print("    context = get_recommendation_context(recommendation_id)")
print("    ")
print("    # 2. å¾å€™é¸æ± ä¸­éæ¿¾")
print("    candidate_pool = get_candidate_pool(")
print("        restaurant_name=context['restaurant'],")
print("        category=category")
print("    )")
print("    ")
print("    # 3. æ’é™¤å·²ç¶“é¡¯ç¤ºéçš„èœå“")
print("    available = [")
print("        dish for dish in candidate_pool")
print("        if dish['name'] not in excluded_dishes")
print("    ]")
print("    ")
print("    # 4. æ ¹æ“šè©•åˆ†æ’åº")
print("    available.sort(key=lambda x: x['rating'], reverse=True)")
print("    ")
print("    if not available:")
print("        return {'error': 'è©²é¡åˆ¥æš«ç„¡å…¶ä»–æ¨è–¦'}")
print("    ")
print("    return available[0]")
print("```")
print()

print("=" * 80)
print("ğŸ¯ å€™é¸æ± ç”Ÿæˆç­–ç•¥")
print("=" * 80)
print()

print("### å•é¡Œï¼šå¦‚ä½•æ±ºå®šæ¯å€‹é¡åˆ¥çš„å€™é¸æ± å¤§å°ï¼Ÿ")
print()
print("å»ºè­°ç­–ç•¥ï¼š")
print()
print("```python")
print("def calculate_candidate_pool_size(category, people, budget):")
print("    '''")
print("    æ ¹æ“šé¡åˆ¥ç‰¹æ€§æ±ºå®šå€™é¸æ± å¤§å°")
print("    '''")
print("    base_sizes = {")
print("        'ç†±èœ': 5,  # ç†±èœé¸æ“‡é€šå¸¸è¼ƒå¤š")
print("        'å†·èœ': 3,  # å†·èœé¸æ“‡è¼ƒå°‘")
print("        'ä¸»é£Ÿ': 4,")
print("        'æ¹¯å“': 3,")
print("        'é»å¿ƒ': 4")
print("    }")
print("    ")
print("    base = base_sizes.get(category, 3)")
print("    ")
print("    # æ ¹æ“šäººæ•¸èª¿æ•´ï¼ˆäººè¶Šå¤šï¼Œé¸æ“‡è¶Šå¤šï¼‰")
print("    if people >= 6:")
print("        base += 2")
print("    elif people >= 4:")
print("        base += 1")
print("    ")
print("    return base")
print("```")
print()

print("ç¯„ä¾‹ï¼š")
print("  2äººç”¨é¤ â†’ ç†±èœå€™é¸æ±  5 é“")
print("  4äººç”¨é¤ â†’ ç†±èœå€™é¸æ±  6 é“")
print("  6äººç”¨é¤ â†’ ç†±èœå€™é¸æ±  7 é“")
print()

print("=" * 80)
print("ğŸš¨ é‚Šç•Œæ¢ä»¶è™•ç†")
print("=" * 80)
print()

print("### æƒ…å¢ƒ 1ï¼šå€™é¸æ± å®Œå…¨ç”¨å®Œ")
print()
print("```")
print("å•é¡Œï¼šä½¿ç”¨è€…æ›äº† 10 æ¬¡ï¼Œæ‰€æœ‰å€™é¸éƒ½ç”¨å®Œäº†")
print()
print("è™•ç†ï¼š")
print("  1. é¡¯ç¤ºæç¤ºã€Œè©²é¡åˆ¥æš«ç„¡æ›´å¤šæ¨è–¦ã€")
print("  2. æä¾›é¸é …ï¼š")
print("     - ã€Œä¿ç•™ç•¶å‰èœå“ã€")
print("     - ã€ŒæŸ¥çœ‹ä¹‹å‰æ›æ‰çš„èœå“ã€ï¼ˆå›æº¯åŠŸèƒ½ï¼‰")
print("```")
print()

print("### æƒ…å¢ƒ 2ï¼šæ›èœå¾Œåƒ¹æ ¼åŠ‡çƒˆè®ŠåŒ–")
print()
print("```")
print("å•é¡Œï¼šå¾ $180 çš„èœæ›æˆ $350 çš„èœ")
print()
print("è™•ç†ï¼š")
print("  1. é¡¯ç¤ºåƒ¹æ ¼å·®ç•°è­¦å‘Šã€Œ+$170 âš ï¸ã€")
print("  2. æ›´æ–°ç¸½åƒ¹ä¸¦æª¢æŸ¥æ˜¯å¦è¶…é ç®—")
print("  3. å¦‚æœè¶…é ç®— >20%ï¼Œå½ˆå‡ºè­¦å‘Š")
print("```")
print()

print("### æƒ…å¢ƒ 3ï¼šå€™é¸æ± å“è³ªæ§åˆ¶")
print()
print("```")
print("å•é¡Œï¼šå€™é¸æ± ä¸­æœ‰äº›èœçš„è©•åˆ†å¾ˆä½")
print()
print("è™•ç†ï¼š")
print("  1. è¨­å®šæœ€ä½è©•åˆ†é–¾å€¼ï¼ˆä¾‹å¦‚ï¼š3.5 æ˜Ÿï¼‰")
print("  2. éæ¿¾æ‰è©•åˆ†éä½çš„èœå“")
print("  3. ç¢ºä¿å€™é¸æ± ä¸­çš„èœéƒ½æ˜¯ã€Œå¯æ¨è–¦ã€çš„å“è³ª")
print("```")
print()

print("=" * 80)
print("âœ… ç¸½çµï¼šå€™é¸æ± è¨­è¨ˆåŸå‰‡")
print("=" * 80)
print()

print("1. âœ… åªæ¨è–¦ AI è©•ä¼°éçš„èœå“ï¼ˆä¸æ˜¯å…¨èœå–®ï¼‰")
print("2. âœ… å€™é¸æ± å¤§å°é©ä¸­ï¼ˆ3-5 é“å‚™é¸ï¼‰")
print("3. âœ… æ··åˆç­–ç•¥ï¼ˆå‰ç«¯è¼ªæ’­ + API è£œå……ï¼‰")
print("4. âœ… åƒ¹æ ¼ç¯„åœå¯æ§ï¼ˆå€™é¸æ± å…§åƒ¹æ ¼æ‡‰æ¥è¿‘ï¼‰")
print("5. âœ… å“è³ªé–€æª»ï¼ˆæœ€ä½è©•åˆ†ã€è©•è«–æ•¸è¦æ±‚ï¼‰")
print()

print("=" * 80)
print("ğŸ“Š å¯¦éš›æ¡ˆä¾‹")
print("=" * 80)
print()

print("### æ¡ˆä¾‹ï¼šé¼æ³°è±ï¼Œ2äººç”¨é¤ï¼Œé ç®— $1000")
print()
print("åˆå§‹æ¨è–¦ï¼š")
print("```")
print("å†·èœï¼ˆé¡¯ç¤ºï¼‰ï¼šæ¶¼æ‹Œé»ƒç“œ $80")
print("  å‚™é¸æ± ï¼š[çš®è›‹è±†è… $100, æ³¡èœ $60]")
print()
print("ç†±èœï¼ˆé¡¯ç¤ºï¼‰ï¼šå®®ä¿é›ä¸ $180")
print("  å‚™é¸æ± ï¼š[ç³–é†‹é­š $220, ç´…ç‡’è‚‰ $280, éº»å©†è±†è… $160, é­šé¦™è‚‰çµ² $180]")
print()
print("ä¸»é£Ÿï¼ˆé¡¯ç¤ºï¼‰ï¼šè›‹ç‚’é£¯ $120")
print("  å‚™é¸æ± ï¼š[æšå·ç‚’é£¯ $150, ç™½é£¯ $30, ç‚’éºµ $130]")
print()
print("æ¹¯å“ï¼ˆé¡¯ç¤ºï¼‰ï¼šé…¸è¾£æ¹¯ $100")
print("  å‚™é¸æ± ï¼š[ç‰ç±³æ¿ƒæ¹¯ $90, è›‹èŠ±æ¹¯ $80]")
print()
print("é»å¿ƒï¼ˆé¡¯ç¤ºï¼‰ï¼šå°ç± åŒ… $200")
print("  å‚™é¸æ± ï¼š[è¦é¤ƒ $180, ç‡’è³£ $160, é‹è²¼ $140]")
print("```")
print()

print("ä½¿ç”¨è€…æ“ä½œï¼š")
print("  1. ç¢ºå®š æ¶¼æ‹Œé»ƒç“œ")
print("  2. æ›æ‰ å®®ä¿é›ä¸ â†’ ç³–é†‹é­šï¼ˆå¾å‚™é¸æ± ï¼‰")
print("  3. ç¢ºå®š è›‹ç‚’é£¯")
print("  4. æ›æ‰ é…¸è¾£æ¹¯ â†’ ç‰ç±³æ¿ƒæ¹¯ï¼ˆå¾å‚™é¸æ± ï¼‰")
print("  5. å†æ› ç‰ç±³æ¿ƒæ¹¯ â†’ è›‹èŠ±æ¹¯ï¼ˆå¾å‚™é¸æ± ï¼‰")
print("  6. å†æ› è›‹èŠ±æ¹¯ â†’ å‘¼å« APIï¼ˆå‚™é¸æ± ç”¨å®Œï¼‰")
print()

print("=" * 80)
