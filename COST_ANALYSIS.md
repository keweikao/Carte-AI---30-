# Carte AI æˆæœ¬åˆ†æžå ±å‘Š

## ðŸ“Š å–®æ¬¡æŽ¨è–¦çš„æˆæœ¬çµæ§‹

### 1. Google Places API è²»ç”¨
**ä½¿ç”¨çš„ APIï¼š**
- `Place Details` (å« reviews, photos, rating ç­‰)
- `Place Photos` (æœ€å¤š 3 å¼µç…§ç‰‡)
- `Place Autocomplete` (æœå°‹é¤å»³æ™‚)

**è²»ç”¨è¨ˆç®—ï¼š**
- Place Details (Basic Data): **$0.017 USD / æ¬¡**
- Place Photos (per photo): **$0.007 USD / å¼µ** Ã— 3 = **$0.021 USD**
- Place Autocomplete (per session): **$0.00283 USD / æ¬¡**

**å°è¨ˆï¼š** ~**$0.041 USD / æ¬¡** (ç´„ **NT$ 1.3**)

---

### 2. Gemini API è²»ç”¨
**ä½¿ç”¨çš„æ¨¡åž‹ï¼š** `gemini-2.5-flash`

**è¼¸å…¥ Token ä¼°ç®—ï¼š**
- Prompt (ç³»çµ±æŒ‡ä»¤ + ä½¿ç”¨è€…éœ€æ±‚): ~2,000 tokens
- Menu Data (truncated to 20,000 chars): ~5,000 tokens
- Reviews Data (truncated to 15,000 chars): ~4,000 tokens
- Images (3 å¼µç…§ç‰‡): ~258 tokens/image Ã— 3 = ~774 tokens

**ç¸½è¼¸å…¥ï¼š** ~**11,774 tokens**

**è¼¸å‡º Token ä¼°ç®—ï¼š**
- æŽ¨è–¦ 20-25 é“èœçš„ JSON: ~3,000 tokens

**Gemini 2.5 Flash å®šåƒ¹ï¼ˆ2024å¹´12æœˆï¼‰ï¼š**
- Input: **$0.075 / 1M tokens** (â‰¤128K context)
- Output: **$0.30 / 1M tokens**

**è²»ç”¨è¨ˆç®—ï¼š**
- Input: 11,774 Ã— $0.075 / 1,000,000 = **$0.00088 USD**
- Output: 3,000 Ã— $0.30 / 1,000,000 = **$0.0009 USD**

**å°è¨ˆï¼š** ~**$0.00178 USD / æ¬¡** (ç´„ **NT$ 0.056**)

---

### 3. Cloud Run é‹ç®—è²»ç”¨
**å‡è¨­ï¼š**
- CPU: 1 vCPU
- Memory: 512 MB
- å¹³å‡è™•ç†æ™‚é–“: 15 ç§’

**è²»ç”¨è¨ˆç®—ï¼š**
- vCPU: $0.00002400 / vCPU-second Ã— 15s = **$0.00036 USD**
- Memory: $0.00000250 / GB-second Ã— 0.5GB Ã— 15s = **$0.00001875 USD**

**å°è¨ˆï¼š** ~**$0.00038 USD / æ¬¡** (ç´„ **NT$ 0.012**)

---

### 4. Firestore è²»ç”¨
**æ“ä½œï¼š**
- Read (cache check): 1 æ¬¡
- Write (save recommendation + activity): 2 æ¬¡

**è²»ç”¨è¨ˆç®—ï¼š**
- Read: $0.06 / 100,000 reads = **$0.0000006 USD**
- Write: $0.18 / 100,000 writes Ã— 2 = **$0.0000036 USD**

**å°è¨ˆï¼š** ~**$0.0000042 USD / æ¬¡** (ç´„ **NT$ 0.0001**ï¼Œå¯å¿½ç•¥)

---

## ðŸ’° ç¸½æˆæœ¬ä¼°ç®—

| é …ç›® | æˆæœ¬ (USD) | æˆæœ¬ (TWD) |
|------|-----------|-----------|
| Google Places API | $0.041 | NT$ 1.30 |
| Gemini API | $0.00178 | NT$ 0.056 |
| Cloud Run | $0.00038 | NT$ 0.012 |
| Firestore | $0.0000042 | ~$0 |
| **ç¸½è¨ˆ** | **$0.043** | **NT$ 1.37** |

---

## ðŸ“ˆ å®šåƒ¹å»ºè­°

### æ–¹æ¡ˆ 1ï¼šä¿å®ˆå®šåƒ¹ï¼ˆæˆæœ¬ Ã— 20-30ï¼‰
- **å–®æ¬¡**: NT$ 30 âœ… (æ¯›åˆ©çŽ‡ ~95%)
- **æœˆè²»**: NT$ 90 (å‡è¨­å¹³å‡ 30 æ¬¡/æœˆï¼Œæˆæœ¬ ~NT$ 41ï¼Œæ¯›åˆ©çŽ‡ ~54%)
- **å¹´è²»**: NT$ 720 (å‡è¨­å¹³å‡ 360 æ¬¡/å¹´ï¼Œæˆæœ¬ ~NT$ 493ï¼Œæ¯›åˆ©çŽ‡ ~31%)

### æ–¹æ¡ˆ 2ï¼šæ¿€é€²å®šåƒ¹ï¼ˆæˆæœ¬ Ã— 10-15ï¼‰
- **å–®æ¬¡**: NT$ 15-20
- **æœˆè²»**: NT$ 60 (å‡è¨­ 30 æ¬¡/æœˆï¼Œæ¯›åˆ©çŽ‡ ~31%)
- **å¹´è²»**: NT$ 500 (å‡è¨­ 360 æ¬¡/å¹´ï¼Œæ¯›åˆ©çŽ‡ ~1%)

---

## ðŸŽ¯ å„ªåŒ–å»ºè­°

### 1. é™ä½Ž Google Places API æˆæœ¬
- **Cache ç­–ç•¥**ï¼šå·²å¯¦ä½œ âœ…
- **æ¸›å°‘ Photo æ•¸é‡**ï¼šå¾ž 3 å¼µé™åˆ° 1-2 å¼µ â†’ çœ $0.007-0.014 USD/æ¬¡
- **ä½¿ç”¨ Place Search** æ›¿ä»£ Place Detailsï¼ˆæŸäº›å ´æ™¯ï¼‰

### 2. é™ä½Ž Gemini API æˆæœ¬
- **Prompt å„ªåŒ–**ï¼šæ¸›å°‘ä¸å¿…è¦çš„ç¯„ä¾‹å’Œèªªæ˜Ž
- **Menu/Reviews Truncation**ï¼šå·²å¯¦ä½œ âœ…
- **è€ƒæ…®ä½¿ç”¨ Gemini 1.5 Flash**ï¼ˆæ›´ä¾¿å®œï¼Œä½†å¯èƒ½æ•ˆæžœç¨å·®ï¼‰

### 3. æé«˜ Cache å‘½ä¸­çŽ‡
- **å»¶é•· Cache TTL**ï¼šå¾ž 7 å¤©å»¶é•·åˆ° 30 å¤©
- **é ç†±ç†±é–€é¤å»³**ï¼šæå‰æŠ“å–è³‡æ–™

---

## ðŸ“Š æç›Šå¹³è¡¡åˆ†æž

### å‡è¨­ï¼šæœˆè²» NT$ 90ï¼Œå¹³å‡ä½¿ç”¨ 30 æ¬¡/æœˆ

| ç”¨æˆ¶æ•¸ | æœˆç‡Ÿæ”¶ | æœˆæˆæœ¬ | æœˆæ¯›åˆ© | æ¯›åˆ©çŽ‡ |
|--------|--------|--------|--------|--------|
| 100 | NT$ 9,000 | NT$ 4,110 | NT$ 4,890 | 54% |
| 500 | NT$ 45,000 | NT$ 20,550 | NT$ 24,450 | 54% |
| 1,000 | NT$ 90,000 | NT$ 41,100 | NT$ 48,900 | 54% |

### å‡è¨­ï¼šå–®æ¬¡ NT$ 30

| æ¯æœˆä½¿ç”¨æ¬¡æ•¸ | æœˆç‡Ÿæ”¶ | æœˆæˆæœ¬ | æœˆæ¯›åˆ© | æ¯›åˆ©çŽ‡ |
|-------------|--------|--------|--------|--------|
| 1,000 | NT$ 30,000 | NT$ 1,370 | NT$ 28,630 | 95% |
| 5,000 | NT$ 150,000 | NT$ 6,850 | NT$ 143,150 | 95% |
| 10,000 | NT$ 300,000 | NT$ 13,700 | NT$ 286,300 | 95% |

---

## âœ… çµè«–

**æ‚¨ç›®å‰çš„å®šåƒ¹ç­–ç•¥éžå¸¸åˆç†ï¼**

- **å–®æ¬¡ NT$ 30**ï¼šæˆæœ¬ NT$ 1.37ï¼Œæ¯›åˆ©çŽ‡ **95%** âœ…
- **æœˆè²» NT$ 90**ï¼šå‡è¨­ 30 æ¬¡/æœˆï¼Œæ¯›åˆ©çŽ‡ **54%** âœ…
- **å¹´è²» NT$ 720**ï¼šå‡è¨­ 360 æ¬¡/å¹´ï¼Œæ¯›åˆ©çŽ‡ **31%** âš ï¸ (åä½Žï¼Œä½†å¯æŽ¥å—)

**å»ºè­°ï¼š**
1. **ç¶­æŒç›®å‰å®šåƒ¹**ï¼Œè§€å¯Ÿå¯¦éš›ä½¿ç”¨é »çŽ‡
2. **å„ªåŒ– Cache ç­–ç•¥**ï¼Œé™ä½Ž Google Places API æˆæœ¬
3. **è€ƒæ…®æŽ¨å‡ºã€Œè¼•é‡ç‰ˆã€**ï¼ˆä¸å«ç…§ç‰‡åˆ†æžï¼‰é™ä½Žæˆæœ¬
4. **ç›£æŽ§é‡åº¦ç”¨æˆ¶**ï¼Œé¿å…è¢«æ¿«ç”¨ï¼ˆæœˆè²»ç”¨æˆ¶æ¯æœˆä½¿ç”¨ >100 æ¬¡ï¼‰
